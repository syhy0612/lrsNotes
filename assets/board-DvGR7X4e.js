import{_ as q,I as j,r as S,C as Y,J as Z,o as u,z as X,w as p,b as a,y as le,K as R,c as v,F as N,L as J,A as E,t as ee,f as O,M as ie,N as G,v as ne,e as n,B as L,O as ue,P as de,Q as A,R as _,j as pe,k as ve,h as re,S as ge,T as me,U as fe,V as _e,W as ae,X as he,Y as ye,H as Se,Z as xe,D as $e}from"./index-DYFviLrP.js";/* empty css                   *//* empty css                 *//* empty css                  */const we=""+new URL("hand-up-DIAiWQej.svg",import.meta.url).href,be=""+new URL("hand-down-ERN56488.svg",import.meta.url).href,oe="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20viewBox='0%200%201600%201600'%3e%3cdefs%3e%3cstyle%3e%20.cls-1,%20.cls-2,%20.cls-3%20{%20stroke:%20%23000;%20}%20.cls-1,%20.cls-4%20{%20fill:%20none;%20}%20.cls-5%20{%20fill:%20%23eecabc;%20}%20.cls-2,%20.cls-6%20{%20fill:%20red;%20}%20.cls-2,%20.cls-3%20{%20stroke-width:%2016px;%20}%20.cls-2,%20.cls-3,%20.cls-4%20{%20stroke-miterlimit:%2010;%20}%20.cls-7%20{%20fill:%20%23fff;%20}%20.cls-3%20{%20opacity:%20.5;%20}%20.cls-8%20{%20display:%20none;%20}%20.cls-9%20{%20fill:%20%23bf0000;%20}%20.cls-4%20{%20stroke:%20red;%20stroke-width:%2099px;%20}%20%3c/style%3e%3c/defs%3e%3cg%3e%3cg%20id='bottom'%3e%3cpolygon%20class='cls-6'%20points='100%201272.9%20100%201572.9%201500%201572.9%201500%201272.9%201450%201272.9%201450%201522.9%20150%201522.9%20150%201272.9%20100%201272.9'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ke={class:"role-options"},Ve={__name:"RoleSelector",props:{currentRole:{type:String,default:""},placement:{type:String,default:"right"}},emits:["update:role"],setup(I,{emit:M}){const x=I,$=j(()=>x.placement),l=M,i=S(!1),B=Y(),{selectedMode:U}=Z(B),k=j(()=>{var y;return[...((y=U.value)==null?void 0:y.roles)||[],{text:"神",color:"gold"},{text:"好人",color:"gold"},{text:"金水",color:"gold"},{text:"银水",color:"gold"},{text:"警1",color:"green"},{text:"警2",color:"green"},{text:"警3",color:"green"},{text:"X",color:"green"},{text:"你",color:"purple"}]}),h=j(()=>{var y;const w=k.value.find(m=>m.text===x.currentRole)||{color:"gray"};return["hexagon",x.currentRole?`hexagon-${w.color}`:"hexagon-gray",((y=x.currentRole)==null?void 0:y.length)===1?"hexagon-one":"hexagon-two",{active:i.value}]}),s=w=>{x.currentRole===w?(l("update:role",""),i.value=!1):(l("update:role",w),i.value=!1)};return(w,y)=>(u(),X(E(ie),{visible:i.value,"onUpdate:visible":y[0]||(y[0]=m=>i.value=m),placement:$.value,width:160,trigger:"click"},{reference:p(()=>[a("div",{class:le(h.value)},R(I.currentRole||"未选"),3)]),default:p(()=>[a("div",ke,[(u(!0),v(N,null,J(k.value,m=>(u(),X(E(ee),{key:m.text,size:"small",class:le([`hexagon-${m.color}`,"role-button"]),onClick:T=>s(m.text)},{default:p(()=>[O(R(m.text),1)]),_:2},1032,["class","onClick"]))),128))])]),_:1},8,["visible","placement"]))}},se=q(Ve,[["__scopeId","data-v-762d801c"]]),ce=I=>(fe("data-v-fb335e91"),I=I(),_e(),I),Ce={class:"game-settings"},Re={key:0,class:"mode-config"},Ie=ce(()=>a("h4",null,"角色",-1)),Be={class:"role-options"},Ue={class:"role-group wolves"},Oe={key:0,class:"role-count hexagon"},Ee={class:"hexagon hexagon-red"},Te={class:"role-group villagers"},Ne={key:0,class:"role-count hexagon"},Me={class:"hexagon hexagon-blue"},Je=ce(()=>a("h4",null,"快捷短语",-1)),je={class:"config-view-container"},ze={key:0,class:"config-view"},Ae={class:"actions"},Pe={__name:"GameSettings",emits:["update-config"],setup(I,{expose:M,emit:x}){const $=x,l=Y(),{gameModes:i}=Z(l),B=S("config"),U=S(null),k=S(JSON.parse(JSON.stringify(i.value))),h=S(!1),s=j(()=>i.value.find(d=>d.id===U.value)),w=j(()=>!s.value||!s.value.roles?[]:s.value.roles.filter(d=>d.color==="red")),y=j(()=>!s.value||!s.value.roles?[]:s.value.roles.filter(d=>d.color==="blue")),m=d=>{l.selectMode(d)},T=()=>{h.value=!0},P=()=>{s.value&&(s.value.phrases.push({label:"",value:""}),T())},z=d=>{s.value&&(s.value.phrases.splice(d,1),T())},D=()=>{A.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{W()}).catch(()=>{_({type:"info",message:"已取消保存",duration:500})})},W=()=>{$("update-config",i.value),k.value=JSON.parse(JSON.stringify(i.value)),h.value=!1,_({type:"success",message:"配置已保存",duration:500})},F=()=>{A.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{H()}).catch(()=>{_({type:"info",message:"已取消重置",duration:500})})},H=()=>{l.resetToOriginal(),i.value=JSON.parse(JSON.stringify(l.gameModes)),k.value=JSON.parse(JSON.stringify(i.value)),h.value=!1,_({type:"warning",message:"配置已重置",duration:500})},K=()=>{if(s.value){const d=JSON.stringify(s.value,null,2);navigator.clipboard.writeText(d).then(()=>{_({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(V=>{console.error("无法复制文本: ",V),_({message:"复制失败，请手动复制",type:"error",duration:500})})}};return G(i,()=>{h.value=JSON.stringify(i.value)!==JSON.stringify(k.value)},{deep:!0}),ne(()=>{U.value=l.selectedModeId}),M({handleClose:d=>{h.value?A.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{W(),d(!0)}).catch(V=>{V==="cancel"?(h.value=!1,d(!0)):d(!1)}):d(!0)}}),(d,V)=>{const e=pe,o=ve,f=re,C=ee,b=ge,g=me;return u(),v("div",Ce,[n(o,{modelValue:U.value,"onUpdate:modelValue":V[0]||(V[0]=r=>U.value=r),placeholder:"选择游戏版型",onChange:m},{default:p(()=>[(u(!0),v(N,null,J(E(i),r=>(u(),X(e,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(g,{modelValue:B.value,"onUpdate:modelValue":V[1]||(V[1]=r=>B.value=r)},{default:p(()=>[n(b,{label:"版型配置",name:"config"},{default:p(()=>[s.value?(u(),v("div",Re,[a("h3",null,R(s.value.name)+" 配置",1),Ie,a("div",Be,[a("div",Ue,[(u(!0),v(N,null,J(w.value,r=>(u(),v("div",{key:r.text,class:"role-container"},[r.count>1?(u(),v("div",Oe,R(r.count),1)):L("",!0),a("div",Ee,R(r.text),1)]))),128))]),a("div",Te,[(u(!0),v(N,null,J(y.value,r=>(u(),v("div",{key:r.text,class:"role-container"},[r.count>1?(u(),v("div",Ne,R(r.count),1)):L("",!0),a("div",Me,R(r.text),1)]))),128))])]),Je,(u(!0),v(N,null,J(s.value.phrases,(r,t)=>(u(),v("div",{key:t,class:"phrase-input"},[n(f,{modelValue:s.value.phrases[t].label,"onUpdate:modelValue":c=>s.value.phrases[t].label=c,placeholder:"标签",onInput:T},{prepend:p(()=>[O("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(f,{modelValue:s.value.phrases[t].value,"onUpdate:modelValue":c=>s.value.phrases[t].value=c,placeholder:"值",onInput:T},{prepend:p(()=>[O("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(C,{onClick:c=>z(t),type:"danger",icon:E(ue),circle:""},null,8,["onClick","icon"])]))),128)),n(C,{onClick:P,type:"primary"},{default:p(()=>[O("添加短语")]),_:1})])):L("",!0)]),_:1}),n(b,{label:"查看配置",name:"view"},{default:p(()=>[a("div",je,[n(C,{class:"copy-button",icon:E(de),circle:"",onClick:K},null,8,["icon"]),s.value?(u(),v("pre",ze,R(JSON.stringify(s.value,null,2)),1)):L("",!0)])]),_:1})]),_:1},8,["modelValue"]),a("div",Ae,[n(C,{onClick:D,type:"primary",disabled:!h.value},{default:p(()=>[O("保存配置")]),_:1},8,["disabled"]),n(C,{onClick:F,type:"warning"},{default:p(()=>[O("重置配置")]),_:1})])])}}},De=q(Pe,[["__scopeId","data-v-fb335e91"]]),We={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24"},Le=a("path",{d:"M12.5 2a.5.5 0 0 0-.5.5V12h-2V4.5a.5.5 0 0 0-1 0V14H7c-.38-1.62-1.358-2.56-2.405-2.678A89 89 0 0 0 6.166 15.1c.86 1.962 1.725 3.422 2.838 4.399C10.078 20.442 11.459 21 13.5 21a5.5 5.5 0 0 0 5.5-5.5V7a.5.5 0 0 0-1 0v5h-2V4a.5.5 0 0 0-1 0v8h-2V2.5a.5.5 0 0 0-.5-.5M21 15.5a7.5 7.5 0 0 1-7.5 7.5c-2.458 0-4.328-.692-5.816-1.998-1.45-1.274-2.459-3.064-3.35-5.1-.93-2.127-1.444-3.422-1.724-4.178-.357-.964.136-2.312 1.476-2.406a4.02 4.02 0 0 1 2.914.94V4.5a2.5 2.5 0 0 1 3.04-2.442 2.5 2.5 0 0 1 4.79-.467A2.502 2.502 0 0 1 18 4v.55q.243-.05.5-.05A2.5 2.5 0 0 1 21 7z"},null,-1),Ge=[Le];function Fe(I,M){return u(),v("svg",We,[...Ge])}const He={render:Fe},Ke={class:"outBox"},Qe={class:"note note-top"},Xe={class:"note"},qe={class:"players-container"},Ye={class:"players-column"},Ze={class:"messageInfo"},et={class:"messageInfo-left"},tt=["src","alt","title","onClick"],lt={class:"player-number"},at={class:"messageInfo-right"},ot={class:"players-column"},st={class:"messageInfo"},nt={class:"messageInfo-left"},rt=["src","alt","title","onClick"],ct={class:"player-number"},it={class:"messageInfo-right"},ut={class:"dialog-footer"},dt={__name:"board",setup(I){const M=Y(),{selectedMode:x}=Z(M),$=S(""),l=S(Object.fromEntries(Array.from({length:12},(e,o)=>[`player${String(o+1).padStart(2,"0")}`,{election:3,flag:!0,message:"",sign:"",status:1}]))),i=S(!1),B=S(""),U=j(()=>x.value?x.value.phrases:[]),k=S(!1),h=S(null),s=S("50%"),w=S(window.innerWidth),y=()=>{w.value>=768?s.value="50%":s.value="80%"};G(w,e=>{y()}),ne(()=>{const e=localStorage.getItem("remarks");e&&($.value=e);const o=localStorage.getItem("chatRecords");o&&Object.assign(l.value,JSON.parse(o)),y();const f=()=>{w.value=window.innerWidth};window.addEventListener("resize",f)});const m=e=>{const o=l.value[e];o.message=o.message.trim(),$.value=$.value.trim()};G($,e=>{localStorage.setItem("remarks",e)},{deep:!0}),G(l,e=>{localStorage.setItem("chatRecords",JSON.stringify(e))},{deep:!0});const T=(e,o)=>{l.value[e].sign=o};function P(e){switch(e){case 1:return we;case 2:return be;case 3:return oe;default:return oe}}function z(e){switch(e){case 1:return"警上刚手";case 2:return"警上放手";case 3:return"警下";default:return"警下"}}function D(e){e.election=e.election%3+1}const W=()=>{A.confirm("确定要重置自记信息吗？","重置自记信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{$.value="",_({type:"success",message:"自记信息已重置",duration:500})}).catch(()=>{_({type:"info",message:"已取消重置",duration:500})})},F=()=>{A.confirm("确定要重置所有玩家的发言内容吗？","重置发言信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(l.value).forEach(e=>{l.value[e].message="",l.value[e].sign="",l.value[e].election=3}),_({type:"success",message:"所有发言信息已重置",duration:500})}).catch(()=>{_({type:"info",message:"已取消重置",duration:500})})},H=()=>{A.confirm("确定要使所有玩家更新为上警举手状态吗？","一键上警",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(l.value).forEach(e=>{l.value[e].election=1}),_({type:"success",message:"所有玩家已上警",duration:500})}).catch(()=>{_({type:"info",message:"已取消更新",duration:500})})},K=()=>{let e=`版型：${x.value?x.value.name:"未选择"}
`;e+=`♫♪♫♪♫♪♫♪♫♪♫♪♫♪
`,e+=`自记信息：
${$.value.trim()}
`,e+=`♫♪♫♪♫♪♫♪♫♪♫♪♫♪
`;const o=Object.entries(l.value).filter(([b,g])=>g.election===1||g.election===2).map(([b,g])=>b.slice(-2)),f=Object.entries(l.value).filter(([b,g])=>g.election===3).map(([b,g])=>b.slice(-2));o.length>0&&(o.length===12?e+=`（全员上警）
`:(e+=`警上：[${o.join(",")}]
`,e+=`警下：[${f.join(",")}]
`),e+=`♫♪♫♪♫♪♫♪♫♪♫♪♫♪
`),e+=`发言信息：
`;const C=f.length===12;Object.entries(l.value).forEach(([b,g])=>{const r=b.slice(-2);let t="";C||(t=g.election===1||g.election===2?"*":"_");const c=g.message.split(`
`);if(c.length>0){e+=`[${r}]${t} ${c[0]}
`;for(let Q=1;Q<c.length;Q++)e+=`   	 ${c[Q]}
`}}),B.value=e.trim(),i.value=!0},te=()=>{navigator.clipboard.writeText(B.value).then(()=>{_({message:"信息已复制到剪贴板",type:"success",duration:2e3}),i.value=!1}).catch(()=>{_({message:"复制失败，请手动复制",type:"error",duration:2e3})})},d=e=>{h.value?h.value.handleClose(o=>{o&&(k.value=!1,e())}):e()},V=e=>{M.updateGameModes(e)};return(e,o)=>{const f=ee,C=re,b=Se,g=xe,r=$e;return u(),v(N,null,[a("div",Ke,[a("div",Qe,[a("h2",null,[O("自记信息 "),n(f,{plain:"",type:"primary",onClick:W,size:"small",icon:E(ae),class:"reset-button"},null,8,["icon"]),n(f,{plain:"",type:"primary",onClick:K,size:"small",icon:E(he),class:"reset-button"},null,8,["icon"])]),n(C,{modelValue:$.value,"onUpdate:modelValue":o[0]||(o[0]=t=>$.value=t),type:"textarea",class:"note-textarea",rows:4,placeholder:"请输入自记信息",onBlur:o[1]||(o[1]=t=>m(null))},null,8,["modelValue"])]),a("div",Xe,[a("h2",null,[O("发言信息 "),n(f,{plain:"",type:"primary",onClick:F,size:"small",icon:E(ae),class:"reset-button"},null,8,["icon"]),n(f,{plain:"",type:"primary",onClick:H,size:"small",class:"reset-button"},{default:p(()=>[n(b,null,{default:p(()=>[n(E(He))]),_:1})]),_:1})]),a("div",qe,[a("div",Ye,[(u(),v(N,null,J(6,t=>a("div",{key:`player${t}`,class:"player-item"},[a("div",Ze,[a("div",et,[a("img",{src:P(l.value[`player${String(t).padStart(2,"0")}`].election),alt:z(l.value[`player${String(t).padStart(2,"0")}`].election),title:z(l.value[`player${String(t).padStart(2,"0")}`].election),onClick:c=>D(l.value[`player${String(t).padStart(2,"0")}`])},null,8,tt),a("div",lt,R(String(t).padStart(2,"0")),1),n(se,{currentRole:l.value[`player${String(t).padStart(2,"0")}`].sign,"onUpdate:role":c=>T(`player${String(t).padStart(2,"0")}`,c),placement:"right"},null,8,["currentRole","onUpdate:role"])]),a("div",at,[n(g,{modelValue:l.value[`player${String(t).padStart(2,"0")}`].message,"onUpdate:modelValue":c=>l.value[`player${String(t).padStart(2,"0")}`].message=c,type:"textarea",class:"note-textarea",rows:3,placeholder:`请输入${t}号玩家发言信息`,prefix:["A","C"],options:U.value,onBlur:c=>m(`player${String(t).padStart(2,"0")}`)},null,8,["modelValue","onUpdate:modelValue","placeholder","options","onBlur"])])])])),64))]),a("div",ot,[(u(),v(N,null,J(6,t=>a("div",{key:`player${t+6}`,class:"player-item"},[a("div",st,[a("div",nt,[a("img",{src:P(l.value[`player${String(t+6).padStart(2,"0")}`].election),alt:z(l.value[`player${String(t+6).padStart(2,"0")}`].election),title:z(l.value[`player${String(t+6).padStart(2,"0")}`].election),onClick:c=>D(l.value[`player${String(t+6).padStart(2,"0")}`])},null,8,rt),a("div",ct,R(String(t+6).padStart(2,"0")),1),n(se,{currentRole:l.value[`player${String(t+6).padStart(2,"0")}`].sign,"onUpdate:role":c=>T(`player${String(t+6).padStart(2,"0")}`,c),placement:"left"},null,8,["currentRole","onUpdate:role"])]),a("div",it,[n(g,{modelValue:l.value[`player${String(t+6).padStart(2,"0")}`].message,"onUpdate:modelValue":c=>l.value[`player${String(t+6).padStart(2,"0")}`].message=c,type:"textarea",class:"note-textarea",rows:3,placeholder:`请输入${t+6}号玩家发言信息`,prefix:["A","C"],options:U.value,onBlur:c=>m(`player${String(t+6).padStart(2,"0")}`)},null,8,["modelValue","onUpdate:modelValue","placeholder","options","onBlur"])])])])),64))])])]),n(r,{modelValue:k.value,"onUpdate:modelValue":o[2]||(o[2]=t=>k.value=t),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":d,class:"settings-dialog"},{default:p(()=>[n(De,{ref_key:"gameSettingsRef",ref:h,onUpdateConfig:V},null,512)]),_:1},8,["modelValue"])]),n(r,{modelValue:i.value,"onUpdate:modelValue":o[4]||(o[4]=t=>i.value=t),title:"导出信息","close-on-click-modal":!1,style:ye({width:s.value})},{footer:p(()=>[a("span",ut,[n(f,{type:"primary",onClick:te},{default:p(()=>[O(" 复制到剪贴板 ")]),_:1})])]),default:p(()=>[n(C,{modelValue:B.value,"onUpdate:modelValue":o[3]||(o[3]=t=>B.value=t),type:"textarea",rows:24,class:"export-textarea"},null,8,["modelValue"])]),_:1},8,["modelValue","style"])],64)}}},ft=q(dt,[["__scopeId","data-v-c3b35dd8"]]);export{ft as B,De as G};
