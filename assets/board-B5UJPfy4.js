import{_ as K,I as B,r as k,C as Q,J as W,o as r,z as L,w as p,b as e,y as Y,K as y,c as u,F as I,L as U,A as O,t as X,f as V,M as ce,N as F,v as le,e as n,B as j,O as ie,P as ue,Q as J,R as S,j as de,k as pe,h as ae,S as ge,T as ve,U as me,V as fe,W as Z,X as _e,D as he}from"./index-BvB_sU_I.js";/* empty css                   *//* empty css                 *//* empty css                  */const ye=""+new URL("hand-up-DIAiWQej.svg",import.meta.url).href,Se=""+new URL("hand-down-ERN56488.svg",import.meta.url).href,ee="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20viewBox='0%200%201600%201600'%3e%3cdefs%3e%3cstyle%3e%20.cls-1,%20.cls-2,%20.cls-3%20{%20stroke:%20%23000;%20}%20.cls-1,%20.cls-4%20{%20fill:%20none;%20}%20.cls-5%20{%20fill:%20%23eecabc;%20}%20.cls-2,%20.cls-6%20{%20fill:%20red;%20}%20.cls-2,%20.cls-3%20{%20stroke-width:%2016px;%20}%20.cls-2,%20.cls-3,%20.cls-4%20{%20stroke-miterlimit:%2010;%20}%20.cls-7%20{%20fill:%20%23fff;%20}%20.cls-3%20{%20opacity:%20.5;%20}%20.cls-8%20{%20display:%20none;%20}%20.cls-9%20{%20fill:%20%23bf0000;%20}%20.cls-4%20{%20stroke:%20red;%20stroke-width:%2099px;%20}%20%3c/style%3e%3c/defs%3e%3cg%3e%3cg%20id='bottom'%3e%3cpolygon%20class='cls-6'%20points='100%201272.9%20100%201572.9%201500%201572.9%201500%201272.9%201450%201272.9%201450%201522.9%20150%201522.9%20150%201272.9%20100%201272.9'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",xe={class:"role-options"},$e={__name:"RoleSelector",props:{currentRole:{type:String,default:""},placement:{type:String,default:"right"}},emits:["update:role"],setup(b,{emit:N}){const _=b,x=B(()=>_.placement),t=N,c=k(!1),C=Q(),{selectedMode:h}=W(C),$=B(()=>{var v;return[...((v=h.value)==null?void 0:v.roles)||[],{text:"神",color:"gold"},{text:"好人",color:"gold"},{text:"金水",color:"gold"},{text:"银水",color:"gold"},{text:"警1",color:"green"},{text:"警2",color:"green"},{text:"警3",color:"green"},{text:"X",color:"green"},{text:"你",color:"purple"}]}),g=B(()=>{var v;const f=$.value.find(m=>m.text===_.currentRole)||{color:"gray"};return["hexagon",_.currentRole?`hexagon-${f.color}`:"hexagon-gray",((v=_.currentRole)==null?void 0:v.length)===1?"hexagon-one":"hexagon-two",{active:c.value}]}),l=f=>{_.currentRole===f?(t("update:role",""),c.value=!1):(t("update:role",f),c.value=!1)};return(f,v)=>(r(),L(O(ce),{visible:c.value,"onUpdate:visible":v[0]||(v[0]=m=>c.value=m),placement:x.value,width:160,trigger:"click"},{reference:p(()=>[e("div",{class:Y(g.value)},y(b.currentRole||"未选"),3)]),default:p(()=>[e("div",xe,[(r(!0),u(I,null,U($.value,m=>(r(),L(O(X),{key:m.text,size:"small",class:Y([`hexagon-${m.color}`,"role-button"]),onClick:R=>l(m.text)},{default:p(()=>[V(y(m.text),1)]),_:2},1032,["class","onClick"]))),128))])]),_:1},8,["visible","placement"]))}},te=K($e,[["__scopeId","data-v-762d801c"]]),se=b=>(me("data-v-fb335e91"),b=b(),fe(),b),ke={class:"game-settings"},be={key:0,class:"mode-config"},Ce=se(()=>e("h4",null,"角色",-1)),we={class:"role-options"},Ve={class:"role-group wolves"},Re={key:0,class:"role-count hexagon"},Ie={class:"hexagon hexagon-red"},Ue={class:"role-group villagers"},Be={key:0,class:"role-count hexagon"},Oe={class:"hexagon hexagon-blue"},Ne=se(()=>e("h4",null,"快捷短语",-1)),Te={class:"config-view-container"},Ee={key:0,class:"config-view"},Me={class:"actions"},Je={__name:"GameSettings",emits:["update-config"],setup(b,{expose:N,emit:_}){const x=_,t=Q(),{gameModes:c}=W(t),C=k("config"),h=k(null),$=k(JSON.parse(JSON.stringify(c.value))),g=k(!1),l=B(()=>c.value.find(o=>o.id===h.value)),f=B(()=>!l.value||!l.value.roles?[]:l.value.roles.filter(o=>o.color==="red")),v=B(()=>!l.value||!l.value.roles?[]:l.value.roles.filter(o=>o.color==="blue")),m=o=>{t.selectMode(o)},R=()=>{g.value=!0},z=()=>{l.value&&(l.value.phrases.push({label:"",value:""}),R())},a=o=>{l.value&&(l.value.phrases.splice(o,1),R())},d=()=>{J.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{T()}).catch(()=>{S({type:"info",message:"已取消保存",duration:500})})},T=()=>{x("update-config",c.value),$.value=JSON.parse(JSON.stringify(c.value)),g.value=!1,S({type:"success",message:"配置已保存",duration:500})},D=()=>{J.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{A()}).catch(()=>{S({type:"info",message:"已取消重置",duration:500})})},A=()=>{t.resetToOriginal(),c.value=JSON.parse(JSON.stringify(t.gameModes)),$.value=JSON.parse(JSON.stringify(c.value)),g.value=!1,S({type:"warning",message:"配置已重置",duration:500})},G=()=>{if(l.value){const o=JSON.stringify(l.value,null,2);navigator.clipboard.writeText(o).then(()=>{S({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(w=>{console.error("无法复制文本: ",w),S({message:"复制失败，请手动复制",type:"error",duration:500})})}};return F(c,()=>{g.value=JSON.stringify(c.value)!==JSON.stringify($.value)},{deep:!0}),le(()=>{h.value=t.selectedModeId}),N({handleClose:o=>{g.value?J.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{T(),o(!0)}).catch(w=>{w==="cancel"?(g.value=!1,o(!0)):o(!1)}):o(!0)}}),(o,w)=>{const oe=de,ne=pe,q=ae,M=X,H=ge,re=ve;return r(),u("div",ke,[n(ne,{modelValue:h.value,"onUpdate:modelValue":w[0]||(w[0]=i=>h.value=i),placeholder:"选择游戏版型",onChange:m},{default:p(()=>[(r(!0),u(I,null,U(O(c),i=>(r(),L(oe,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(re,{modelValue:C.value,"onUpdate:modelValue":w[1]||(w[1]=i=>C.value=i)},{default:p(()=>[n(H,{label:"版型配置",name:"config"},{default:p(()=>[l.value?(r(),u("div",be,[e("h3",null,y(l.value.name)+" 配置",1),Ce,e("div",we,[e("div",Ve,[(r(!0),u(I,null,U(f.value,i=>(r(),u("div",{key:i.text,class:"role-container"},[i.count>1?(r(),u("div",Re,y(i.count),1)):j("",!0),e("div",Ie,y(i.text),1)]))),128))]),e("div",Ue,[(r(!0),u(I,null,U(v.value,i=>(r(),u("div",{key:i.text,class:"role-container"},[i.count>1?(r(),u("div",Be,y(i.count),1)):j("",!0),e("div",Oe,y(i.text),1)]))),128))])]),Ne,(r(!0),u(I,null,U(l.value.phrases,(i,E)=>(r(),u("div",{key:E,class:"phrase-input"},[n(q,{modelValue:l.value.phrases[E].label,"onUpdate:modelValue":P=>l.value.phrases[E].label=P,placeholder:"标签",onInput:R},{prepend:p(()=>[V("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(q,{modelValue:l.value.phrases[E].value,"onUpdate:modelValue":P=>l.value.phrases[E].value=P,placeholder:"值",onInput:R},{prepend:p(()=>[V("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(M,{onClick:P=>a(E),type:"danger",icon:O(ie),circle:""},null,8,["onClick","icon"])]))),128)),n(M,{onClick:z,type:"primary"},{default:p(()=>[V("添加短语")]),_:1})])):j("",!0)]),_:1}),n(H,{label:"查看配置",name:"view"},{default:p(()=>[e("div",Te,[n(M,{class:"copy-button",icon:O(ue),circle:"",onClick:G},null,8,["icon"]),l.value?(r(),u("pre",Ee,y(JSON.stringify(l.value,null,2)),1)):j("",!0)])]),_:1})]),_:1},8,["modelValue"]),e("div",Me,[n(M,{onClick:d,type:"primary",disabled:!g.value},{default:p(()=>[V("保存配置")]),_:1},8,["disabled"]),n(M,{onClick:D,type:"warning"},{default:p(()=>[V("重置配置")]),_:1})])])}}},Ae=K(Je,[["__scopeId","data-v-fb335e91"]]),Pe={class:"outBox"},je={class:"note note-top"},ze={class:"note"},De={class:"players-container"},Ge={class:"players-column"},Le={class:"messageInfo"},Fe={class:"messageInfo-left"},Ke=["src","alt","title","onClick"],Qe={class:"player-number"},We={class:"messageInfo-right"},Xe={class:"players-column"},qe={class:"messageInfo"},He={class:"messageInfo-left"},Ye=["src","alt","title","onClick"],Ze={class:"player-number"},et={class:"messageInfo-right"},tt={__name:"board",setup(b){const N=Q(),{selectedMode:_}=W(N),x=k(""),t=k(Object.fromEntries(Array.from({length:12},(a,d)=>[`player${String(d+1).padStart(2,"0")}`,{election:3,flag:!0,message:"",sign:"",status:1}]))),c=B(()=>_.value?_.value.phrases:[]),C=k(!1),h=k(null);le(()=>{const a=localStorage.getItem("remarks");a&&(x.value=a);const d=localStorage.getItem("chatRecords");d&&Object.assign(t.value,JSON.parse(d))}),F(x,a=>{localStorage.setItem("remarks",a)},{deep:!0}),F(t,a=>{localStorage.setItem("chatRecords",JSON.stringify(a))},{deep:!0});const $=(a,d)=>{t.value[a].sign=d};function g(a){switch(a){case 1:return ye;case 2:return Se;case 3:return ee;default:return ee}}function l(a){switch(a){case 1:return"警上刚手";case 2:return"警上放手";case 3:return"警下";default:return"警下"}}function f(a){a.election=a.election%3+1}const v=()=>{J.confirm("确定要重置自记信息吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{x.value="",S({type:"success",message:"自记信息已重置",duration:500})}).catch(()=>{S({type:"info",message:"已取消重置",duration:500})})},m=()=>{J.confirm("确定要重置所有玩家的发言内容吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(t.value).forEach(a=>{t.value[a].message="",t.value[a].sign="",t.value[a].election=3}),S({type:"success",message:"所有发言信息已重置",duration:500})}).catch(()=>{S({type:"info",message:"已取消重置",duration:500})})},R=a=>{h.value?h.value.handleClose(d=>{d&&(C.value=!1,a())}):a()},z=a=>{N.updateGameModes(a)};return(a,d)=>{const T=X,D=ae,A=_e,G=he;return r(),u("div",Pe,[e("div",je,[e("h2",null,[V("自记信息 "),n(T,{plain:"",type:"primary",onClick:v,size:"small",icon:O(Z),class:"reset-button"},null,8,["icon"])]),n(D,{modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=s=>x.value=s),type:"textarea",class:"note-textarea",rows:4,placeholder:"请输入自记信息"},null,8,["modelValue"])]),e("div",ze,[e("h2",null,[V("发言信息 "),n(T,{plain:"",type:"primary",onClick:m,size:"small",icon:O(Z),class:"reset-button"},null,8,["icon"])]),e("div",De,[e("div",Ge,[(r(),u(I,null,U(6,s=>e("div",{key:`player${s}`,class:"player-item"},[e("div",Le,[e("div",Fe,[e("img",{src:g(t.value[`player${String(s).padStart(2,"0")}`].election),alt:l(t.value[`player${String(s).padStart(2,"0")}`].election),title:l(t.value[`player${String(s).padStart(2,"0")}`].election),onClick:o=>f(t.value[`player${String(s).padStart(2,"0")}`])},null,8,Ke),e("div",Qe,y(String(s).padStart(2,"0")),1),n(te,{currentRole:t.value[`player${String(s).padStart(2,"0")}`].sign,"onUpdate:role":o=>$(`player${String(s).padStart(2,"0")}`,o),placement:"right"},null,8,["currentRole","onUpdate:role"])]),e("div",We,[n(A,{modelValue:t.value[`player${String(s).padStart(2,"0")}`].message,"onUpdate:modelValue":o=>t.value[`player${String(s).padStart(2,"0")}`].message=o,type:"textarea",class:"note-textarea",rows:3,placeholder:`请输入${s}号玩家发言信息`,prefix:["A","C"],options:c.value},null,8,["modelValue","onUpdate:modelValue","placeholder","options"])])])])),64))]),e("div",Xe,[(r(),u(I,null,U(6,s=>e("div",{key:`player${s+6}`,class:"player-item"},[e("div",qe,[e("div",He,[e("img",{src:g(t.value[`player${String(s+6).padStart(2,"0")}`].election),alt:l(t.value[`player${String(s+6).padStart(2,"0")}`].election),title:l(t.value[`player${String(s+6).padStart(2,"0")}`].election),onClick:o=>f(t.value[`player${String(s+6).padStart(2,"0")}`])},null,8,Ye),e("div",Ze,y(String(s+6).padStart(2,"0")),1),n(te,{currentRole:t.value[`player${String(s+6).padStart(2,"0")}`].sign,"onUpdate:role":o=>$(`player${String(s+6).padStart(2,"0")}`,o),placement:"left"},null,8,["currentRole","onUpdate:role"])]),e("div",et,[n(A,{modelValue:t.value[`player${String(s+6).padStart(2,"0")}`].message,"onUpdate:modelValue":o=>t.value[`player${String(s+6).padStart(2,"0")}`].message=o,type:"textarea",class:"note-textarea",rows:3,placeholder:`请输入${s+6}号玩家发言信息`,prefix:["A","C"],options:c.value},null,8,["modelValue","onUpdate:modelValue","placeholder","options"])])])])),64))])])]),n(G,{modelValue:C.value,"onUpdate:modelValue":d[1]||(d[1]=s=>C.value=s),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":R,class:"settings-dialog"},{default:p(()=>[n(Ae,{ref_key:"gameSettingsRef",ref:h,onUpdateConfig:z},null,512)]),_:1},8,["modelValue"])])}}},nt=K(tt,[["__scopeId","data-v-205c0226"]]);export{nt as B,Ae as G};
