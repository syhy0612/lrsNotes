import{_ as $,v as G,x as Z,r as C,y as B,z as ee,A as R,o as l,c,e as s,w as u,F as N,B as w,C as T,D as te,b as n,G as v,H as M,f as S,I as ae,J as se,K as J,L as f,j as oe,k as le,h as ne,t as L,M as ce,N as ue,O as ie,P as re,Q as de,R as pe,S as _e,T as ve}from"./index-BYXKur2O.js";/* empty css                  */const P=m=>(ie("data-v-7187b426"),m=m(),re(),m),fe={class:"game-settings"},me={key:0,class:"mode-config"},ge=P(()=>n("h4",null,"角色",-1)),he={class:"role-options"},ye={class:"role-group wolves"},be={key:0,class:"role-count hexagon"},Se={class:"hexagon hexagon-red"},Ce={class:"role-group villagers"},xe={key:0,class:"role-count hexagon"},ke={class:"hexagon hexagon-blue"},Ve=P(()=>n("h4",null,"快捷短语",-1)),Ne={class:"config-view-container"},we={key:0,class:"config-view"},Me={class:"actions"},Te={__name:"devGameSettings",emits:["update-config"],setup(m,{expose:g,emit:h}){const O=h,r=G(),{gameModes:o}=Z(r),x=C("config"),p=C(null),y=C(JSON.parse(JSON.stringify(o.value))),i=C(!1),e=B(()=>o.value.find(a=>a.id===p.value)),A=B(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(a=>a.color==="red")),D=B(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(a=>a.color==="blue")),F=a=>{r.selectMode(a)},k=()=>{i.value=!0},j=()=>{e.value&&(e.value.phrases.push({label:"",value:""}),k())},z=a=>{e.value&&(e.value.phrases.splice(a,1),k())},H=()=>{J.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I()}).catch(()=>{f({type:"info",message:"已取消保存",duration:500})})},I=()=>{O("update-config",o.value),y.value=JSON.parse(JSON.stringify(o.value)),i.value=!1,f({type:"success",message:"配置已保存",duration:500})},K=()=>{J.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Q()}).catch(()=>{f({type:"info",message:"已取消重置",duration:500})})},Q=()=>{r.resetToOriginal(),o.value=JSON.parse(JSON.stringify(r.gameModes)),y.value=JSON.parse(JSON.stringify(o.value)),i.value=!1,f({type:"warning",message:"配置已重置",duration:500})},q=()=>{if(e.value){const a=JSON.stringify(e.value,null,2);navigator.clipboard.writeText(a).then(()=>{f({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(d=>{console.error("无法复制文本: ",d),f({message:"复制失败，请手动复制",type:"error",duration:500})})}};return ee(o,()=>{i.value=JSON.stringify(o.value)!==JSON.stringify(y.value)},{deep:!0}),R(()=>{p.value=r.selectedModeId}),g({handleClose:a=>{i.value?J.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{I(),a(!0)}).catch(d=>{d==="cancel"?(i.value=!1,a(!0)):a(!1)}):a(!0)}}),(a,d)=>{const W=oe,X=le,E=ne,b=L,U=ce,Y=ue;return l(),c("div",fe,[s(X,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=t=>p.value=t),placeholder:"选择游戏版型",onChange:F},{default:u(()=>[(l(!0),c(N,null,w(T(o),t=>(l(),te(W,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(Y,{modelValue:x.value,"onUpdate:modelValue":d[1]||(d[1]=t=>x.value=t)},{default:u(()=>[s(U,{label:"版型配置",name:"config"},{default:u(()=>[e.value?(l(),c("div",me,[n("h3",null,v(e.value.name)+" 配置",1),ge,n("div",he,[n("div",ye,[(l(!0),c(N,null,w(A.value,t=>(l(),c("div",{key:t.text,class:"role-container"},[t.count>1?(l(),c("div",be,v(t.count),1)):M("",!0),n("div",Se,v(t.text),1)]))),128))]),n("div",Ce,[(l(!0),c(N,null,w(D.value,t=>(l(),c("div",{key:t.text,class:"role-container"},[t.count>1?(l(),c("div",xe,v(t.count),1)):M("",!0),n("div",ke,v(t.text),1)]))),128))])]),Ve,(l(!0),c(N,null,w(e.value.phrases,(t,_)=>(l(),c("div",{key:_,class:"phrase-input"},[s(E,{modelValue:e.value.phrases[_].label,"onUpdate:modelValue":V=>e.value.phrases[_].label=V,placeholder:"标签",onInput:k},{prepend:u(()=>[S("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(E,{modelValue:e.value.phrases[_].value,"onUpdate:modelValue":V=>e.value.phrases[_].value=V,placeholder:"值",onInput:k},{prepend:u(()=>[S("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(b,{onClick:V=>z(_),type:"danger",icon:T(ae),circle:""},null,8,["onClick","icon"])]))),128)),s(b,{onClick:j,type:"primary"},{default:u(()=>[S("添加短语")]),_:1})])):M("",!0)]),_:1}),s(U,{label:"查看配置",name:"view"},{default:u(()=>[n("div",Ne,[s(b,{class:"copy-button",icon:T(se),circle:"",onClick:q},null,8,["icon"]),e.value?(l(),c("pre",we,v(JSON.stringify(e.value,null,2)),1)):M("",!0)])]),_:1})]),_:1},8,["modelValue"]),n("div",Me,[s(b,{onClick:H,type:"primary",disabled:!i.value},{default:u(()=>[S("保存配置")]),_:1},8,["disabled"]),s(b,{onClick:K,type:"warning"},{default:u(()=>[S("重置配置")]),_:1})])])}}},Oe=$(Te,[["__scopeId","data-v-7187b426"]]),Be={class:"bgColor"},Je={class:"header"},Ie={class:"controls"},Ee={class:"content"},Ue={class:"section"},$e={__name:"testMain",setup(m){const g=C(!1),h=G(),O=r=>{h.updateGameModes(r),h.saveToLocalStorage()};return R(()=>{h.loadFromLocalStorage()}),(r,o)=>{const x=_e,p=L,y=de;return l(),c("div",Be,[n("div",Je,[n("div",Ie,[s(p,{onClick:o[0]||(o[0]=i=>g.value=!0),class:"settings-button"},{default:u(()=>[s(x,null,{default:u(()=>[s(T(ve))]),_:1})]),_:1})])]),n("div",Ee,[n("div",Ue,[s(pe)])]),s(y,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=i=>g.value=i),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,class:"settings-dialog"},{default:u(()=>[s(Oe,{onUpdateConfig:O})]),_:1},8,["modelValue"])])}}},Pe=$($e,[["__scopeId","data-v-7df02f9c"]]);export{Pe as default};
