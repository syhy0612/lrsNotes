import{_ as $,G,H as Z,r as C,I as O,J as ee,v as R,o as l,c,e as o,w as u,F as N,K as w,A as T,z as te,b as n,L as v,B as M,f as S,M as ae,N as oe,O as J,P as m,j as se,k as le,h as ne,t as L,Q as ce,R as ue,C as ie,D as re,S as de,T as pe,U as _e}from"./index-BZ4ZsU1C.js";/* empty css                   *//* empty css                 */import"./searchTypes-D132cJ-h.js";import{B as ve}from"./board-CYAYKFKD.js";/* empty css                  *//* empty css                  */const P=f=>(ie("data-v-7187b426"),f=f(),re(),f),me={class:"game-settings"},fe={key:0,class:"mode-config"},ge=P(()=>n("h4",null,"角色",-1)),he={class:"role-options"},ye={class:"role-group wolves"},be={key:0,class:"role-count hexagon"},Se={class:"hexagon hexagon-red"},Ce={class:"role-group villagers"},ke={key:0,class:"role-count hexagon"},xe={class:"hexagon hexagon-blue"},Ve=P(()=>n("h4",null,"快捷短语",-1)),Ne={class:"config-view-container"},we={key:0,class:"config-view"},Me={class:"actions"},Te={__name:"devGameSettings",emits:["update-config"],setup(f,{expose:g,emit:h}){const B=h,r=G(),{gameModes:s}=Z(r),k=C("config"),p=C(null),y=C(JSON.parse(JSON.stringify(s.value))),i=C(!1),e=O(()=>s.value.find(a=>a.id===p.value)),A=O(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(a=>a.color==="red")),D=O(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(a=>a.color==="blue")),F=a=>{r.selectMode(a)},x=()=>{i.value=!0},j=()=>{e.value&&(e.value.phrases.push({label:"",value:""}),x())},z=a=>{e.value&&(e.value.phrases.splice(a,1),x())},H=()=>{J.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I()}).catch(()=>{m({type:"info",message:"已取消保存",duration:500})})},I=()=>{B("update-config",s.value),y.value=JSON.parse(JSON.stringify(s.value)),i.value=!1,m({type:"success",message:"配置已保存",duration:500})},K=()=>{J.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Q()}).catch(()=>{m({type:"info",message:"已取消重置",duration:500})})},Q=()=>{r.resetToOriginal(),s.value=JSON.parse(JSON.stringify(r.gameModes)),y.value=JSON.parse(JSON.stringify(s.value)),i.value=!1,m({type:"warning",message:"配置已重置",duration:500})},q=()=>{if(e.value){const a=JSON.stringify(e.value,null,2);navigator.clipboard.writeText(a).then(()=>{m({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(d=>{console.error("无法复制文本: ",d),m({message:"复制失败，请手动复制",type:"error",duration:500})})}};return ee(s,()=>{i.value=JSON.stringify(s.value)!==JSON.stringify(y.value)},{deep:!0}),R(()=>{p.value=r.selectedModeId}),g({handleClose:a=>{i.value?J.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{I(),a(!0)}).catch(d=>{d==="cancel"?(i.value=!1,a(!0)):a(!1)}):a(!0)}}),(a,d)=>{const W=se,X=le,E=ne,b=L,U=ce,Y=ue;return l(),c("div",me,[o(X,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=t=>p.value=t),placeholder:"选择游戏版型",onChange:F},{default:u(()=>[(l(!0),c(N,null,w(T(s),t=>(l(),te(W,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o(Y,{modelValue:k.value,"onUpdate:modelValue":d[1]||(d[1]=t=>k.value=t)},{default:u(()=>[o(U,{label:"版型配置",name:"config"},{default:u(()=>[e.value?(l(),c("div",fe,[n("h3",null,v(e.value.name)+" 配置",1),ge,n("div",he,[n("div",ye,[(l(!0),c(N,null,w(A.value,t=>(l(),c("div",{key:t.text,class:"role-container"},[t.count>1?(l(),c("div",be,v(t.count),1)):M("",!0),n("div",Se,v(t.text),1)]))),128))]),n("div",Ce,[(l(!0),c(N,null,w(D.value,t=>(l(),c("div",{key:t.text,class:"role-container"},[t.count>1?(l(),c("div",ke,v(t.count),1)):M("",!0),n("div",xe,v(t.text),1)]))),128))])]),Ve,(l(!0),c(N,null,w(e.value.phrases,(t,_)=>(l(),c("div",{key:_,class:"phrase-input"},[o(E,{modelValue:e.value.phrases[_].label,"onUpdate:modelValue":V=>e.value.phrases[_].label=V,placeholder:"标签",onInput:x},{prepend:u(()=>[S("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),o(E,{modelValue:e.value.phrases[_].value,"onUpdate:modelValue":V=>e.value.phrases[_].value=V,placeholder:"值",onInput:x},{prepend:u(()=>[S("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),o(b,{onClick:V=>z(_),type:"danger",icon:T(ae),circle:""},null,8,["onClick","icon"])]))),128)),o(b,{onClick:j,type:"primary"},{default:u(()=>[S("添加短语")]),_:1})])):M("",!0)]),_:1}),o(U,{label:"查看配置",name:"view"},{default:u(()=>[n("div",Ne,[o(b,{class:"copy-button",icon:T(oe),circle:"",onClick:q},null,8,["icon"]),e.value?(l(),c("pre",we,v(JSON.stringify(e.value,null,2)),1)):M("",!0)])]),_:1})]),_:1},8,["modelValue"]),n("div",Me,[o(b,{onClick:H,type:"primary",disabled:!i.value},{default:u(()=>[S("保存配置")]),_:1},8,["disabled"]),o(b,{onClick:K,type:"warning"},{default:u(()=>[S("重置配置")]),_:1})])])}}},Be=$(Te,[["__scopeId","data-v-7187b426"]]),Oe={class:"bgColor"},Je={class:"header"},Ie={class:"controls"},Ee={class:"content"},Ue={class:"section"},$e={__name:"testMain",setup(f){const g=C(!1),h=G(),B=r=>{h.updateGameModes(r),h.saveToLocalStorage()};return R(()=>{h.loadFromLocalStorage()}),(r,s)=>{const k=_e,p=L,y=de;return l(),c("div",Oe,[n("div",Je,[n("div",Ie,[o(p,{onClick:s[0]||(s[0]=i=>g.value=!0),class:"settings-button"},{default:u(()=>[o(k,null,{default:u(()=>[o(T(pe))]),_:1})]),_:1})])]),n("div",Ee,[n("div",Ue,[o(ve)])]),o(y,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=i=>g.value=i),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,class:"settings-dialog"},{default:u(()=>[o(Be,{onUpdateConfig:B})]),_:1},8,["modelValue"])])}}},ze=$($e,[["__scopeId","data-v-7df02f9c"]]);export{ze as default};
