import{_ as $,C as G,D as Z,r as k,G as O,H as ee,v as R,o as n,c,e as s,w as i,F as M,I as N,A as w,z as te,b as a,J as f,B as T,f as C,K as se,L as oe,M as J,N as g,j as ae,k as le,h as ne,t as L,O as ce,P as ie,Q as ue,R as re,S as de,T as pe,U as _e}from"./index-BiM0nisx.js";/* empty css                   */import ve from"./searchTypes-BLvdJAGL.js";import{B as me}from"./board-D1ndqEvf.js";/* empty css                 *//* empty css                  *//* empty css                  */const P=h=>(ue("data-v-7187b426"),h=h(),re(),h),fe={class:"game-settings"},ge={key:0,class:"mode-config"},he=P(()=>a("h4",null,"角色",-1)),ye={class:"role-options"},Se={class:"role-group wolves"},be={key:0,class:"role-count hexagon"},Ce={class:"hexagon hexagon-red"},ke={class:"role-group villagers"},xe={key:0,class:"role-count hexagon"},Ve={class:"hexagon hexagon-blue"},Me=P(()=>a("h4",null,"快捷短语",-1)),Ne={class:"config-view-container"},Te={key:0,class:"config-view"},we={class:"actions"},Be={__name:"devGameSettings",emits:["update-config"],setup(h,{expose:y,emit:_}){const B=_,d=G(),{gameModes:l}=Z(d),p=k("config"),v=k(null),S=k(JSON.parse(JSON.stringify(l.value))),u=k(!1),e=O(()=>l.value.find(o=>o.id===v.value)),A=O(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(o=>o.color==="red")),D=O(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(o=>o.color==="blue")),F=o=>{d.selectMode(o)},x=()=>{u.value=!0},j=()=>{e.value&&(e.value.phrases.push({label:"",value:""}),x())},z=o=>{e.value&&(e.value.phrases.splice(o,1),x())},H=()=>{J.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I()}).catch(()=>{g({type:"info",message:"已取消保存",duration:500})})},I=()=>{B("update-config",l.value),S.value=JSON.parse(JSON.stringify(l.value)),u.value=!1,g({type:"success",message:"配置已保存",duration:500})},K=()=>{J.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Q()}).catch(()=>{g({type:"info",message:"已取消重置",duration:500})})},Q=()=>{d.resetToOriginal(),l.value=JSON.parse(JSON.stringify(d.gameModes)),S.value=JSON.parse(JSON.stringify(l.value)),u.value=!1,g({type:"warning",message:"配置已重置",duration:500})},q=()=>{if(e.value){const o=JSON.stringify(e.value,null,2);navigator.clipboard.writeText(o).then(()=>{g({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(r=>{console.error("无法复制文本: ",r),g({message:"复制失败，请手动复制",type:"error",duration:500})})}};return ee(l,()=>{u.value=JSON.stringify(l.value)!==JSON.stringify(S.value)},{deep:!0}),R(()=>{v.value=d.selectedModeId}),y({handleClose:o=>{u.value?J.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{I(),o(!0)}).catch(r=>{r==="cancel"?(u.value=!1,o(!0)):o(!1)}):o(!0)}}),(o,r)=>{const W=ae,X=le,E=ne,b=L,U=ce,Y=ie;return n(),c("div",fe,[s(X,{modelValue:v.value,"onUpdate:modelValue":r[0]||(r[0]=t=>v.value=t),placeholder:"选择游戏版型",onChange:F},{default:i(()=>[(n(!0),c(M,null,N(w(l),t=>(n(),te(W,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(Y,{modelValue:p.value,"onUpdate:modelValue":r[1]||(r[1]=t=>p.value=t)},{default:i(()=>[s(U,{label:"版型配置",name:"config"},{default:i(()=>[e.value?(n(),c("div",ge,[a("h3",null,f(e.value.name)+" 配置",1),he,a("div",ye,[a("div",Se,[(n(!0),c(M,null,N(A.value,t=>(n(),c("div",{key:t.text,class:"role-container"},[t.count>1?(n(),c("div",be,f(t.count),1)):T("",!0),a("div",Ce,f(t.text),1)]))),128))]),a("div",ke,[(n(!0),c(M,null,N(D.value,t=>(n(),c("div",{key:t.text,class:"role-container"},[t.count>1?(n(),c("div",xe,f(t.count),1)):T("",!0),a("div",Ve,f(t.text),1)]))),128))])]),Me,(n(!0),c(M,null,N(e.value.phrases,(t,m)=>(n(),c("div",{key:m,class:"phrase-input"},[s(E,{modelValue:e.value.phrases[m].label,"onUpdate:modelValue":V=>e.value.phrases[m].label=V,placeholder:"标签",onInput:x},{prepend:i(()=>[C("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(E,{modelValue:e.value.phrases[m].value,"onUpdate:modelValue":V=>e.value.phrases[m].value=V,placeholder:"值",onInput:x},{prepend:i(()=>[C("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(b,{onClick:V=>z(m),type:"danger",icon:w(se),circle:""},null,8,["onClick","icon"])]))),128)),s(b,{onClick:j,type:"primary"},{default:i(()=>[C("添加短语")]),_:1})])):T("",!0)]),_:1}),s(U,{label:"查看配置",name:"view"},{default:i(()=>[a("div",Ne,[s(b,{class:"copy-button",icon:w(oe),circle:"",onClick:q},null,8,["icon"]),e.value?(n(),c("pre",Te,f(JSON.stringify(e.value,null,2)),1)):T("",!0)])]),_:1})]),_:1},8,["modelValue"]),a("div",we,[s(b,{onClick:H,type:"primary",disabled:!u.value},{default:i(()=>[C("保存配置")]),_:1},8,["disabled"]),s(b,{onClick:K,type:"warning"},{default:i(()=>[C("重置配置")]),_:1})])])}}},Oe=$(Be,[["__scopeId","data-v-7187b426"]]),Je={class:"bgColor"},Ie={class:"header"},Ee={class:"controls"},Ue={class:"content"},$e={class:"section"},Ge={class:"section"},Re={__name:"testMain",setup(h){const y=k(!1),_=G(),B=l=>{_.selectMode(l)},d=l=>{_.updateGameModes(l),_.saveToLocalStorage()};return R(()=>{_.loadFromLocalStorage()}),(l,p)=>{const v=_e,S=L,u=de;return n(),c("div",Je,[a("div",Ie,[a("div",Ee,[s(S,{onClick:p[0]||(p[0]=e=>y.value=!0),class:"settings-button"},{default:i(()=>[s(v,null,{default:i(()=>[s(w(pe))]),_:1})]),_:1})])]),a("div",Ue,[a("div",$e,[s(ve,{class:"search-types",onSelectMode:B})]),a("div",Ge,[s(me)])]),s(u,{modelValue:y.value,"onUpdate:modelValue":p[1]||(p[1]=e=>y.value=e),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,class:"settings-dialog"},{default:i(()=>[s(Oe,{onUpdateConfig:d})]),_:1},8,["modelValue"])])}}},Ke=$(Re,[["__scopeId","data-v-e2e9f1d8"]]);export{Ke as default};
