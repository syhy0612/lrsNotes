import{_ as P,v as se,x as ae,r as i,y as ne,z as F,A as G,o as w,c as x,b as a,f as S,B as oe,C as z,D as f,e as n,G as re,H as M,w as v,L as ce,F as U,I as D,R as N,J as ie,K as ue,M as de,N as A,O as pe,P as me,Q as T,S as g,t as ge,T as fe,U as ve,h as _e,V as he,W as ye}from"./index-BPXmf-nk.js";const Se={class:"outBox"},we={class:"topText"},xe={class:"full-box"},$e={class:"note"},be={class:"players-container"},ke={class:"players-column"},Ee={class:"messageInfo"},Ve={class:"messageInfo-left"},Ie=["src","alt","title","onClick"],Re={class:"player-number"},Be={class:"messageInfo-right"},Ce={class:"players-column"},Fe={class:"messageInfo"},ze={class:"messageInfo-left"},Ue=["src","alt","title","onClick"],Te={class:"player-number"},Oe={class:"messageInfo-right"},We={class:"note note-top"},je={class:"dialog-footer"},qe={__name:"board-full",setup(J){const $=se(),{selectedMode:u}=ae($),d=i(""),l=i(Object.fromEntries(Array.from({length:12},(e,s)=>[`player${String(s+1).padStart(2,"0")}`,{election:3,flag:!0,message:"",sign:"",status:1}]))),m=i(!1),_=i(""),O=ne(()=>u.value?u.value.phrases:[]),b=i(!1),K=()=>{b.value=!0},H=i(!1),k=i(null),E=i("50%"),V=i(window.innerWidth),W=()=>{V.value>=768?E.value="50%":E.value="80%"},I=i(!1),Q=()=>{const e=document.documentElement;I.value?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),I.value=!I.value};F(V,e=>{W()}),G(()=>{const e=localStorage.getItem("remarks");e&&(d.value=e);const s=localStorage.getItem("chatRecords");s&&Object.assign(l.value,JSON.parse(s)),W();const c=()=>{V.value=window.innerWidth};window.addEventListener("resize",c)});const R=e=>{const s=l.value[e];s.message=s.message.trim(),d.value=d.value.trim()};F(d,e=>{localStorage.setItem("remarks",e)},{deep:!0}),F(l,e=>{localStorage.setItem("chatRecords",JSON.stringify(e))},{deep:!0});const j=(e,s)=>{l.value[e].sign=s};function q(e){switch(e){case 1:return me;case 2:return pe;case 3:return A;default:return A}}function h(e){switch(e){case 1:return"警上刚手";case 2:return"警上放手";case 3:return"警下";default:return"警下"}}function L(e){e.election=e.election%3+1}const X=()=>{T.confirm("确定要重置自记信息吗？","重置自记信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{d.value="",g({type:"success",message:"自记信息已重置",duration:500})}).catch(()=>{g({type:"info",message:"已取消重置",duration:500})})},Y=()=>{T.confirm("确定要重置所有玩家的发言内容吗？","重置发言信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(l.value).forEach(e=>{l.value[e].message="",l.value[e].sign="",l.value[e].election=3}),g({type:"success",message:"所有发言信息已重置",duration:500})}).catch(()=>{g({type:"info",message:"已取消重置",duration:500})})},Z=()=>{T.confirm("确定要使所有玩家更新为上警举手状态吗？","一键上警",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(l.value).forEach(e=>{l.value[e].election=1}),g({type:"success",message:"所有玩家已上警",duration:500})}).catch(()=>{g({type:"info",message:"已取消更新",duration:500})})},ee=()=>{let e=`版型：${u.value?u.value.name:"未选择"}
`;e+=`♫♪♫♪♫♪♫♪♫♪♫♪♫♪
`,e+=`自记信息：
${d.value.trim()}
`,e+=`♫♪♫♪♫♪♫♪♫♪♫♪♫♪
`;const s=Object.entries(l.value).filter(([p,r])=>r.election===1||r.election===2).map(([p,r])=>p.slice(-2)),c=Object.entries(l.value).filter(([p,r])=>r.election===3).map(([p,r])=>p.slice(-2));s.length>0&&(s.length===12?e+=`（全员上警）
`:(e+=`警上：[${s.join(",")}]
`,e+=`警下：[${c.join(",")}]
`),e+=`♫♪♫♪♫♪♫♪♫♪♫♪♫♪
`),e+=`发言信息：
`;const B=c.length===12;Object.entries(l.value).forEach(([p,r])=>{const y=p.slice(-2);let t="";B||(t=r.election===1||r.election===2?"*":"_");const o=r.message.split(`
`);if(o.length>0){e+=`[${y}]${t} ${o[0]}
`;for(let C=1;C<o.length;C++)e+=`   	 ${o[C]}
`}}),_.value=e.trim(),m.value=!0},te=()=>{navigator.clipboard.writeText(_.value).then(()=>{g({message:"信息已复制到剪贴板",type:"success",duration:2e3}),m.value=!1}).catch(()=>{g({message:"复制失败，请手动复制",type:"error",duration:2e3})})},le=e=>{k.value?k.value.handleClose(s=>{s&&(H.value=!1,e())}):e()};return(e,s)=>{const c=ge,B=fe,p=ve,r=_e,y=he;return w(),x(U,null,[a("div",Se,[a("div",we,[S(" 当前版型："),a("a",{href:"#",onClick:oe(K,["prevent"])},z(f(u)?f(u).name:"点击选择"),1),n(c,{plain:"",type:"primary",onClick:Q,size:"small",icon:f(re),class:"reset-button"},null,8,["icon"])]),a("div",xe,[a("div",$e,[a("h2",null,[S("发言信息 "),n(c,{plain:"",type:"primary",onClick:Y,size:"small",icon:f(M),class:"reset-button"},null,8,["icon"]),n(c,{plain:"",type:"primary",onClick:Z,size:"small",class:"reset-button"},{default:v(()=>[n(B,null,{default:v(()=>[n(f(ce))]),_:1})]),_:1})]),a("div",be,[a("div",ke,[(w(),x(U,null,D(6,t=>a("div",{key:`player${t}`,class:"player-item"},[a("div",Ee,[a("div",Ve,[a("img",{src:q(l.value[`player${String(t).padStart(2,"0")}`].election),alt:h(l.value[`player${String(t).padStart(2,"0")}`].election),title:h(l.value[`player${String(t).padStart(2,"0")}`].election),onClick:o=>L(l.value[`player${String(t).padStart(2,"0")}`])},null,8,Ie),a("div",Re,z(String(t).padStart(2,"0")),1),n(N,{currentRole:l.value[`player${String(t).padStart(2,"0")}`].sign,"onUpdate:role":o=>j(`player${String(t).padStart(2,"0")}`,o),placement:"right"},null,8,["currentRole","onUpdate:role"])]),a("div",Be,[n(p,{modelValue:l.value[`player${String(t).padStart(2,"0")}`].message,"onUpdate:modelValue":o=>l.value[`player${String(t).padStart(2,"0")}`].message=o,type:"textarea",class:"note-textarea",rows:6,placeholder:`请输入${t}号玩家发言信息`,prefix:["A","C"],options:O.value,onBlur:o=>R(`player${String(t).padStart(2,"0")}`),style:{"font-size":"14px"}},null,8,["modelValue","onUpdate:modelValue","placeholder","options","onBlur"])])])])),64))]),a("div",Ce,[(w(),x(U,null,D(6,t=>a("div",{key:`player${t+6}`,class:"player-item"},[a("div",Fe,[a("div",ze,[a("img",{src:q(l.value[`player${String(t+6).padStart(2,"0")}`].election),alt:h(l.value[`player${String(t+6).padStart(2,"0")}`].election),title:h(l.value[`player${String(t+6).padStart(2,"0")}`].election),onClick:o=>L(l.value[`player${String(t+6).padStart(2,"0")}`])},null,8,Ue),a("div",Te,z(String(t+6).padStart(2,"0")),1),n(N,{currentRole:l.value[`player${String(t+6).padStart(2,"0")}`].sign,"onUpdate:role":o=>j(`player${String(t+6).padStart(2,"0")}`,o),placement:"left"},null,8,["currentRole","onUpdate:role"])]),a("div",Oe,[n(p,{modelValue:l.value[`player${String(t+6).padStart(2,"0")}`].message,"onUpdate:modelValue":o=>l.value[`player${String(t+6).padStart(2,"0")}`].message=o,type:"textarea",class:"note-textarea",rows:6,placeholder:`请输入${t+6}号玩家发言信息`,prefix:["A","C"],options:O.value,onBlur:o=>R(`player${String(t+6).padStart(2,"0")}`),style:{"font-size":"14px"}},null,8,["modelValue","onUpdate:modelValue","placeholder","options","onBlur"])])])])),64))])])]),a("div",We,[a("h2",null,[S("自记信息 "),n(c,{plain:"",type:"primary",onClick:X,size:"small",icon:f(M),class:"reset-button"},null,8,["icon"]),n(c,{plain:"",type:"primary",onClick:ee,size:"small",icon:f(ie),class:"reset-button"},null,8,["icon"])]),n(r,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),type:"textarea",class:"note-textarea",rows:24,placeholder:"请输入自记信息",onBlur:s[1]||(s[1]=t=>R(null))},null,8,["modelValue"])])]),n(y,{modelValue:b.value,"onUpdate:modelValue":s[2]||(s[2]=t=>b.value=t),title:"设置","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":le,class:"settings-dialog",width:"40%"},{default:v(()=>[n(ue,{ref_key:"gameSettingsRef",ref:k},null,512)]),_:1},8,["modelValue"])]),n(y,{modelValue:m.value,"onUpdate:modelValue":s[4]||(s[4]=t=>m.value=t),title:"导出信息","close-on-click-modal":!1,style:de({width:E.value})},{footer:v(()=>[a("span",je,[n(c,{type:"primary",onClick:te},{default:v(()=>[S(" 复制到剪贴板 ")]),_:1})])]),default:v(()=>[n(r,{modelValue:_.value,"onUpdate:modelValue":s[3]||(s[3]=t=>_.value=t),type:"textarea",rows:24,class:"export-textarea"},null,8,["modelValue"])]),_:1},8,["modelValue","style"])],64)}}},Le=P(qe,[["__scopeId","data-v-a66b16c6"]]),Me={class:"bgColor"},De={class:"outside"},Ne={class:"board"},Ae={__name:"full",setup(J){const $=i(!0),u=()=>{$.value=window.innerWidth>768},d=i(!1),l=()=>{const m=navigator.userAgent.toLowerCase();return/micromessenger/.test(m)&&/mobile/.test(m)};return G(()=>{d.value=l(),u(),window.addEventListener("resize",u)}),ye(()=>{window.removeEventListener("resize",u)}),(m,_)=>(w(),x("div",Me,[a("div",De,[a("div",Ne,[n(Le)])])]))}},Ge=P(Ae,[["__scopeId","data-v-3809e249"]]);export{Ge as default};
