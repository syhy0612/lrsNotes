import{_ as q,I as M,r as b,C as Y,J as Z,o as i,z as W,w as p,b as o,y as te,K as V,c as g,F as E,L as N,A as U,t as ee,f as B,M as ce,N as X,v as se,e as n,B as D,O as ie,P as ue,Q as A,R as f,j as de,k as pe,h as ne,S as ge,T as me,U as ve,V as fe,W as le,X as _e,H as he,Y as ye,D as Se}from"./index-D0cG0hG4.js";/* empty css                   *//* empty css                 *//* empty css                  */const xe=""+new URL("hand-up-DIAiWQej.svg",import.meta.url).href,$e=""+new URL("hand-down-ERN56488.svg",import.meta.url).href,ae="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%20viewBox='0%200%201600%201600'%3e%3cdefs%3e%3cstyle%3e%20.cls-1,%20.cls-2,%20.cls-3%20{%20stroke:%20%23000;%20}%20.cls-1,%20.cls-4%20{%20fill:%20none;%20}%20.cls-5%20{%20fill:%20%23eecabc;%20}%20.cls-2,%20.cls-6%20{%20fill:%20red;%20}%20.cls-2,%20.cls-3%20{%20stroke-width:%2016px;%20}%20.cls-2,%20.cls-3,%20.cls-4%20{%20stroke-miterlimit:%2010;%20}%20.cls-7%20{%20fill:%20%23fff;%20}%20.cls-3%20{%20opacity:%20.5;%20}%20.cls-8%20{%20display:%20none;%20}%20.cls-9%20{%20fill:%20%23bf0000;%20}%20.cls-4%20{%20stroke:%20red;%20stroke-width:%2099px;%20}%20%3c/style%3e%3c/defs%3e%3cg%3e%3cg%20id='bottom'%3e%3cpolygon%20class='cls-6'%20points='100%201272.9%20100%201572.9%201500%201572.9%201500%201272.9%201450%201272.9%201450%201522.9%20150%201522.9%20150%201272.9%20100%201272.9'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",be={class:"role-options"},ke={__name:"RoleSelector",props:{currentRole:{type:String,default:""},placement:{type:String,default:"right"}},emits:["update:role"],setup(C,{emit:T}){const y=C,S=M(()=>y.placement),a=T,c=b(!1),R=Y(),{selectedMode:I}=Z(R),k=M(()=>{var h;return[...((h=I.value)==null?void 0:h.roles)||[],{text:"神",color:"gold"},{text:"好人",color:"gold"},{text:"金水",color:"gold"},{text:"银水",color:"gold"},{text:"警1",color:"green"},{text:"警2",color:"green"},{text:"警3",color:"green"},{text:"X",color:"green"},{text:"你",color:"purple"}]}),_=M(()=>{var h;const x=k.value.find(v=>v.text===y.currentRole)||{color:"gray"};return["hexagon",y.currentRole?`hexagon-${x.color}`:"hexagon-gray",((h=y.currentRole)==null?void 0:h.length)===1?"hexagon-one":"hexagon-two",{active:c.value}]}),s=x=>{y.currentRole===x?(a("update:role",""),c.value=!1):(a("update:role",x),c.value=!1)};return(x,h)=>(i(),W(U(ce),{visible:c.value,"onUpdate:visible":h[0]||(h[0]=v=>c.value=v),placement:S.value,width:160,trigger:"click"},{reference:p(()=>[o("div",{class:te(_.value)},V(C.currentRole||"未选"),3)]),default:p(()=>[o("div",be,[(i(!0),g(E,null,N(k.value,v=>(i(),W(U(ee),{key:v.text,size:"small",class:te([`hexagon-${v.color}`,"role-button"]),onClick:O=>s(v.text)},{default:p(()=>[B(V(v.text),1)]),_:2},1032,["class","onClick"]))),128))])]),_:1},8,["visible","placement"]))}},oe=q(ke,[["__scopeId","data-v-762d801c"]]),re=C=>(ve("data-v-fb335e91"),C=C(),fe(),C),we={class:"game-settings"},Ve={key:0,class:"mode-config"},Ce=re(()=>o("h4",null,"角色",-1)),Re={class:"role-options"},Ie={class:"role-group wolves"},Be={key:0,class:"role-count hexagon"},Ue={class:"hexagon hexagon-red"},Oe={class:"role-group villagers"},Ee={key:0,class:"role-count hexagon"},Te={class:"hexagon hexagon-blue"},Ne=re(()=>o("h4",null,"快捷短语",-1)),Me={class:"config-view-container"},Je={key:0,class:"config-view"},je={class:"actions"},Ae={__name:"GameSettings",emits:["update-config"],setup(C,{expose:T,emit:y}){const S=y,a=Y(),{gameModes:c}=Z(a),R=b("config"),I=b(null),k=b(JSON.parse(JSON.stringify(c.value))),_=b(!1),s=M(()=>c.value.find(e=>e.id===I.value)),x=M(()=>!s.value||!s.value.roles?[]:s.value.roles.filter(e=>e.color==="red")),h=M(()=>!s.value||!s.value.roles?[]:s.value.roles.filter(e=>e.color==="blue")),v=e=>{a.selectMode(e)},O=()=>{_.value=!0},L=()=>{s.value&&(s.value.phrases.push({label:"",value:""}),O())},G=e=>{s.value&&(s.value.phrases.splice(e,1),O())},F=()=>{A.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{P()}).catch(()=>{f({type:"info",message:"已取消保存",duration:500})})},P=()=>{S("update-config",c.value),k.value=JSON.parse(JSON.stringify(c.value)),_.value=!1,f({type:"success",message:"配置已保存",duration:500})},H=()=>{A.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{K()}).catch(()=>{f({type:"info",message:"已取消重置",duration:500})})},K=()=>{a.resetToOriginal(),c.value=JSON.parse(JSON.stringify(a.gameModes)),k.value=JSON.parse(JSON.stringify(c.value)),_.value=!1,f({type:"warning",message:"配置已重置",duration:500})},Q=()=>{if(s.value){const e=JSON.stringify(s.value,null,2);navigator.clipboard.writeText(e).then(()=>{f({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(u=>{console.error("无法复制文本: ",u),f({message:"复制失败，请手动复制",type:"error",duration:500})})}};return X(c,()=>{_.value=JSON.stringify(c.value)!==JSON.stringify(k.value)},{deep:!0}),se(()=>{I.value=a.selectedModeId}),T({handleClose:e=>{_.value?A.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{P(),e(!0)}).catch(u=>{u==="cancel"?(_.value=!1,e(!0)):e(!1)}):e(!0)}}),(e,u)=>{const J=de,$=pe,m=ne,w=ee,l=ge,d=me;return i(),g("div",we,[n($,{modelValue:I.value,"onUpdate:modelValue":u[0]||(u[0]=r=>I.value=r),placeholder:"选择游戏版型",onChange:v},{default:p(()=>[(i(!0),g(E,null,N(U(c),r=>(i(),W(J,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(d,{modelValue:R.value,"onUpdate:modelValue":u[1]||(u[1]=r=>R.value=r)},{default:p(()=>[n(l,{label:"版型配置",name:"config"},{default:p(()=>[s.value?(i(),g("div",Ve,[o("h3",null,V(s.value.name)+" 配置",1),Ce,o("div",Re,[o("div",Ie,[(i(!0),g(E,null,N(x.value,r=>(i(),g("div",{key:r.text,class:"role-container"},[r.count>1?(i(),g("div",Be,V(r.count),1)):D("",!0),o("div",Ue,V(r.text),1)]))),128))]),o("div",Oe,[(i(!0),g(E,null,N(h.value,r=>(i(),g("div",{key:r.text,class:"role-container"},[r.count>1?(i(),g("div",Ee,V(r.count),1)):D("",!0),o("div",Te,V(r.text),1)]))),128))])]),Ne,(i(!0),g(E,null,N(s.value.phrases,(r,j)=>(i(),g("div",{key:j,class:"phrase-input"},[n(m,{modelValue:s.value.phrases[j].label,"onUpdate:modelValue":z=>s.value.phrases[j].label=z,placeholder:"标签",onInput:O},{prepend:p(()=>[B("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(m,{modelValue:s.value.phrases[j].value,"onUpdate:modelValue":z=>s.value.phrases[j].value=z,placeholder:"值",onInput:O},{prepend:p(()=>[B("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),n(w,{onClick:z=>G(j),type:"danger",icon:U(ie),circle:""},null,8,["onClick","icon"])]))),128)),n(w,{onClick:L,type:"primary"},{default:p(()=>[B("添加短语")]),_:1})])):D("",!0)]),_:1}),n(l,{label:"查看配置",name:"view"},{default:p(()=>[o("div",Me,[n(w,{class:"copy-button",icon:U(ue),circle:"",onClick:Q},null,8,["icon"]),s.value?(i(),g("pre",Je,V(JSON.stringify(s.value,null,2)),1)):D("",!0)])]),_:1})]),_:1},8,["modelValue"]),o("div",je,[n(w,{onClick:F,type:"primary",disabled:!_.value},{default:p(()=>[B("保存配置")]),_:1},8,["disabled"]),n(w,{onClick:H,type:"warning"},{default:p(()=>[B("重置配置")]),_:1})])])}}},Pe=q(Ae,[["__scopeId","data-v-fb335e91"]]),ze={xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24"},De=o("path",{d:"M12.5 2a.5.5 0 0 0-.5.5V12h-2V4.5a.5.5 0 0 0-1 0V14H7c-.38-1.62-1.358-2.56-2.405-2.678A89 89 0 0 0 6.166 15.1c.86 1.962 1.725 3.422 2.838 4.399C10.078 20.442 11.459 21 13.5 21a5.5 5.5 0 0 0 5.5-5.5V7a.5.5 0 0 0-1 0v5h-2V4a.5.5 0 0 0-1 0v8h-2V2.5a.5.5 0 0 0-.5-.5M21 15.5a7.5 7.5 0 0 1-7.5 7.5c-2.458 0-4.328-.692-5.816-1.998-1.45-1.274-2.459-3.064-3.35-5.1-.93-2.127-1.444-3.422-1.724-4.178-.357-.964.136-2.312 1.476-2.406a4.02 4.02 0 0 1 2.914.94V4.5a2.5 2.5 0 0 1 3.04-2.442 2.5 2.5 0 0 1 4.79-.467A2.502 2.502 0 0 1 18 4v.55q.243-.05.5-.05A2.5 2.5 0 0 1 21 7z"},null,-1),Le=[De];function Ge(C,T){return i(),g("svg",ze,[...Le])}const Fe={render:Ge},He={class:"outBox"},Ke={class:"note note-top"},Qe={class:"note"},We={class:"players-container"},Xe={class:"players-column"},qe={class:"messageInfo"},Ye={class:"messageInfo-left"},Ze=["src","alt","title","onClick"],et={class:"player-number"},tt={class:"messageInfo-right"},lt={class:"players-column"},at={class:"messageInfo"},ot={class:"messageInfo-left"},st=["src","alt","title","onClick"],nt={class:"player-number"},rt={class:"messageInfo-right"},ct={class:"dialog-footer"},it={__name:"board",setup(C){const T=Y(),{selectedMode:y}=Z(T),S=b(""),a=b(Object.fromEntries(Array.from({length:12},(t,e)=>[`player${String(e+1).padStart(2,"0")}`,{election:3,flag:!0,message:"",sign:"",status:1}]))),c=b(!1),R=b(""),I=M(()=>y.value?y.value.phrases:[]),k=b(!1),_=b(null);se(()=>{const t=localStorage.getItem("remarks");t&&(S.value=t);const e=localStorage.getItem("chatRecords");e&&Object.assign(a.value,JSON.parse(e))});const s=t=>{const e=a.value[t];e.message=e.message.trim(),S.value=S.value.trim()};X(S,t=>{localStorage.setItem("remarks",t)},{deep:!0}),X(a,t=>{localStorage.setItem("chatRecords",JSON.stringify(t))},{deep:!0});const x=(t,e)=>{a.value[t].sign=e};function h(t){switch(t){case 1:return xe;case 2:return $e;case 3:return ae;default:return ae}}function v(t){switch(t){case 1:return"警上刚手";case 2:return"警上放手";case 3:return"警下";default:return"警下"}}function O(t){t.election=t.election%3+1}const L=()=>{A.confirm("确定要重置自记信息吗？","重置自记信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{S.value="",f({type:"success",message:"自记信息已重置",duration:500})}).catch(()=>{f({type:"info",message:"已取消重置",duration:500})})},G=()=>{A.confirm("确定要重置所有玩家的发言内容吗？","重置发言信息",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(a.value).forEach(t=>{a.value[t].message="",a.value[t].sign="",a.value[t].election=3}),f({type:"success",message:"所有发言信息已重置",duration:500})}).catch(()=>{f({type:"info",message:"已取消重置",duration:500})})},F=()=>{A.confirm("确定要使所有玩家更新为上警举手状态吗？","一键上警",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{Object.keys(a.value).forEach(t=>{a.value[t].election=1}),f({type:"success",message:"所有玩家已更新为上警状态",duration:500})}).catch(()=>{f({type:"info",message:"已取消更新",duration:500})})},P=()=>{let t=`版型：${y.value?y.value.name:"未选择"}
`;t+=`◇◆◇◆◇◆◇◆◇◆◇◆◇◆◇◆
`,t+=`自记信息：
${S.value.trim()}
`,t+=`◇◆◇◆◇◆◇◆◇◆◇◆◇◆◇◆
`;const e=Object.entries(a.value).filter(([$,m])=>m.election===1||m.election===2).map(([$,m])=>$.slice(-2)),u=Object.entries(a.value).filter(([$,m])=>m.election===3).map(([$,m])=>$.slice(-2));e.length>0&&(e.length===12?t+=`全员上警
`:(t+=`警上：[${e.join(",")}]
`,t+=`警下：[${u.join(",")}]
`),t+=`◇◆◇◆◇◆◇◆◇◆◇◆◇◆◇◆
`),t+=`发言信息：
`;const J=u.length===12;Object.entries(a.value).forEach(([$,m])=>{const w=$.slice(-2);let l="";J||(l=m.election===1||m.election===2?"*":"_");const d=m.message.split(`
`);if(d.length>0){t+=`[${w}]${l} ${d[0]}
`;for(let r=1;r<d.length;r++)t+=`   	 ${d[r]}
`}}),R.value=t.trim(),c.value=!0},H=()=>{navigator.clipboard.writeText(R.value).then(()=>{f({message:"信息已复制到剪贴板",type:"success",duration:2e3}),c.value=!1}).catch(()=>{f({message:"复制失败，请手动复制",type:"error",duration:2e3})})},K=t=>{_.value?_.value.handleClose(e=>{e&&(k.value=!1,t())}):t()},Q=t=>{T.updateGameModes(t)};return(t,e)=>{const u=ee,J=ne,$=he,m=ye,w=Se;return i(),g(E,null,[o("div",He,[o("div",Ke,[o("h2",null,[B("自记信息 "),n(u,{plain:"",type:"primary",onClick:L,size:"small",icon:U(le),class:"reset-button"},null,8,["icon"]),n(u,{plain:"",type:"primary",onClick:P,size:"small",icon:U(_e),class:"reset-button"},null,8,["icon"])]),n(J,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=l=>S.value=l),type:"textarea",class:"note-textarea",rows:4,placeholder:"请输入自记信息",onBlur:e[1]||(e[1]=l=>s(null))},null,8,["modelValue"])]),o("div",Qe,[o("h2",null,[B("发言信息 "),n(u,{plain:"",type:"primary",onClick:G,size:"small",icon:U(le),class:"reset-button"},null,8,["icon"]),n(u,{plain:"",type:"primary",onClick:F,size:"small",class:"reset-button"},{default:p(()=>[n($,null,{default:p(()=>[n(U(Fe))]),_:1})]),_:1})]),o("div",We,[o("div",Xe,[(i(),g(E,null,N(6,l=>o("div",{key:`player${l}`,class:"player-item"},[o("div",qe,[o("div",Ye,[o("img",{src:h(a.value[`player${String(l).padStart(2,"0")}`].election),alt:v(a.value[`player${String(l).padStart(2,"0")}`].election),title:v(a.value[`player${String(l).padStart(2,"0")}`].election),onClick:d=>O(a.value[`player${String(l).padStart(2,"0")}`])},null,8,Ze),o("div",et,V(String(l).padStart(2,"0")),1),n(oe,{currentRole:a.value[`player${String(l).padStart(2,"0")}`].sign,"onUpdate:role":d=>x(`player${String(l).padStart(2,"0")}`,d),placement:"right"},null,8,["currentRole","onUpdate:role"])]),o("div",tt,[n(m,{modelValue:a.value[`player${String(l).padStart(2,"0")}`].message,"onUpdate:modelValue":d=>a.value[`player${String(l).padStart(2,"0")}`].message=d,type:"textarea",class:"note-textarea",rows:3,placeholder:`请输入${l}号玩家发言信息`,prefix:["A","C"],options:I.value,onBlur:d=>s(`player${String(l).padStart(2,"0")}`)},null,8,["modelValue","onUpdate:modelValue","placeholder","options","onBlur"])])])])),64))]),o("div",lt,[(i(),g(E,null,N(6,l=>o("div",{key:`player${l+6}`,class:"player-item"},[o("div",at,[o("div",ot,[o("img",{src:h(a.value[`player${String(l+6).padStart(2,"0")}`].election),alt:v(a.value[`player${String(l+6).padStart(2,"0")}`].election),title:v(a.value[`player${String(l+6).padStart(2,"0")}`].election),onClick:d=>O(a.value[`player${String(l+6).padStart(2,"0")}`])},null,8,st),o("div",nt,V(String(l+6).padStart(2,"0")),1),n(oe,{currentRole:a.value[`player${String(l+6).padStart(2,"0")}`].sign,"onUpdate:role":d=>x(`player${String(l+6).padStart(2,"0")}`,d),placement:"left"},null,8,["currentRole","onUpdate:role"])]),o("div",rt,[n(m,{modelValue:a.value[`player${String(l+6).padStart(2,"0")}`].message,"onUpdate:modelValue":d=>a.value[`player${String(l+6).padStart(2,"0")}`].message=d,type:"textarea",class:"note-textarea",rows:3,placeholder:`请输入${l+6}号玩家发言信息`,prefix:["A","C"],options:I.value,onBlur:d=>s(`player${String(l+6).padStart(2,"0")}`)},null,8,["modelValue","onUpdate:modelValue","placeholder","options","onBlur"])])])])),64))])])]),n(w,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=l=>k.value=l),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":K,class:"settings-dialog"},{default:p(()=>[n(Pe,{ref_key:"gameSettingsRef",ref:_,onUpdateConfig:Q},null,512)]),_:1},8,["modelValue"])]),n(w,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=l=>c.value=l),title:"导出信息","close-on-click-modal":!1,class:"export-dialog"},{footer:p(()=>[o("span",ct,[n(u,{type:"primary",onClick:H},{default:p(()=>[B(" 复制到剪贴板 ")]),_:1})])]),default:p(()=>[n(J,{modelValue:R.value,"onUpdate:modelValue":e[3]||(e[3]=l=>R.value=l),type:"textarea",rows:24,class:"export-textarea"},null,8,["modelValue"])]),_:1},8,["modelValue"])],64)}}},mt=q(it,[["__scopeId","data-v-d5954140"]]);export{mt as B,Pe as G};
