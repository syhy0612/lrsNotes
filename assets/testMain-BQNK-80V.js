import{_ as U,v as G,x as W,r as C,y as B,z as ee,A as R,o as l,c,e as s,w as u,F as w,I as N,D as M,X as te,b as n,C as v,Y as T,f as S,Z as ae,$ as se,Q as I,S as f,j as oe,k as le,h as ne,t as A,a0 as ce,a1 as ue,a2 as ie,a3 as re,V as de,a4 as pe,T as _e,a5 as ve}from"./index-BPXmf-nk.js";/* empty css                  */const D=m=>(ie("data-v-7187b426"),m=m(),re(),m),fe={class:"game-settings"},me={key:0,class:"mode-config"},ge=D(()=>n("h4",null,"角色",-1)),he={class:"role-options"},ye={class:"role-group wolves"},be={key:0,class:"role-count hexagon"},Se={class:"hexagon hexagon-red"},Ce={class:"role-group villagers"},xe={key:0,class:"role-count hexagon"},Ve={class:"hexagon hexagon-blue"},ke=D(()=>n("h4",null,"快捷短语",-1)),we={class:"config-view-container"},Ne={key:0,class:"config-view"},Te={class:"actions"},Me={__name:"devGameSettings",emits:["update-config"],setup(m,{expose:g,emit:h}){const O=h,r=G(),{gameModes:o}=W(r),x=C("config"),p=C(null),y=C(JSON.parse(JSON.stringify(o.value))),i=C(!1),e=B(()=>o.value.find(a=>a.id===p.value)),F=B(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(a=>a.color==="red")),L=B(()=>!e.value||!e.value.roles?[]:e.value.roles.filter(a=>a.color==="blue")),P=a=>{r.selectMode(a)},V=()=>{i.value=!0},j=()=>{e.value&&(e.value.phrases.push({label:"",value:""}),V())},z=a=>{e.value&&(e.value.phrases.splice(a,1),V())},Q=()=>{I.confirm("确定要保存当前配置吗？这将覆盖之前的配置。","保存确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{J()}).catch(()=>{f({type:"info",message:"已取消保存",duration:500})})},J=()=>{O("update-config",o.value),y.value=JSON.parse(JSON.stringify(o.value)),i.value=!1,f({type:"success",message:"配置已保存",duration:500})},X=()=>{I.confirm("确定要重置所有配置吗？这将丢失所有未保存的更改。","重置确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Y()}).catch(()=>{f({type:"info",message:"已取消重置",duration:500})})},Y=()=>{r.resetToOriginal(),o.value=JSON.parse(JSON.stringify(r.gameModes)),y.value=JSON.parse(JSON.stringify(o.value)),i.value=!1,f({type:"warning",message:"配置已重置",duration:500})},Z=()=>{if(e.value){const a=JSON.stringify(e.value,null,2);navigator.clipboard.writeText(a).then(()=>{f({message:"配置已复制到剪贴板",type:"success",duration:500})}).catch(d=>{console.error("无法复制文本: ",d),f({message:"复制失败，请手动复制",type:"error",duration:500})})}};return ee(o,()=>{i.value=JSON.stringify(o.value)!==JSON.stringify(y.value)},{deep:!0}),R(()=>{p.value=r.selectedModeId}),g({handleClose:a=>{i.value?I.confirm("有未保存的更改，是否保存？","确认",{confirmButtonText:"保存",cancelButtonText:"不保存",type:"warning",distinguishCancelAndClose:!0}).then(()=>{J(),a(!0)}).catch(d=>{d==="cancel"?(i.value=!1,a(!0)):a(!1)}):a(!0)}}),(a,d)=>{const q=oe,H=le,E=ne,b=A,$=ce,K=ue;return l(),c("div",fe,[s(H,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=t=>p.value=t),placeholder:"选择游戏版型",onChange:P},{default:u(()=>[(l(!0),c(w,null,N(M(o),t=>(l(),te(q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(K,{modelValue:x.value,"onUpdate:modelValue":d[1]||(d[1]=t=>x.value=t)},{default:u(()=>[s($,{label:"版型配置",name:"config"},{default:u(()=>[e.value?(l(),c("div",me,[n("h3",null,v(e.value.name)+" 配置",1),ge,n("div",he,[n("div",ye,[(l(!0),c(w,null,N(F.value,t=>(l(),c("div",{key:t.text,class:"role-container"},[t.count>1?(l(),c("div",be,v(t.count),1)):T("",!0),n("div",Se,v(t.text),1)]))),128))]),n("div",Ce,[(l(!0),c(w,null,N(L.value,t=>(l(),c("div",{key:t.text,class:"role-container"},[t.count>1?(l(),c("div",xe,v(t.count),1)):T("",!0),n("div",Ve,v(t.text),1)]))),128))])]),ke,(l(!0),c(w,null,N(e.value.phrases,(t,_)=>(l(),c("div",{key:_,class:"phrase-input"},[s(E,{modelValue:e.value.phrases[_].label,"onUpdate:modelValue":k=>e.value.phrases[_].label=k,placeholder:"标签",onInput:V},{prepend:u(()=>[S("提示")]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(E,{modelValue:e.value.phrases[_].value,"onUpdate:modelValue":k=>e.value.phrases[_].value=k,placeholder:"值",onInput:V},{prepend:u(()=>[S("起跳")]),_:2},1032,["modelValue","onUpdate:modelValue"]),s(b,{onClick:k=>z(_),type:"danger",icon:M(ae),circle:""},null,8,["onClick","icon"])]))),128)),s(b,{onClick:j,type:"primary"},{default:u(()=>[S("添加短语")]),_:1})])):T("",!0)]),_:1}),s($,{label:"查看配置",name:"view"},{default:u(()=>[n("div",we,[s(b,{class:"copy-button",icon:M(se),circle:"",onClick:Z},null,8,["icon"]),e.value?(l(),c("pre",Ne,v(JSON.stringify(e.value,null,2)),1)):T("",!0)])]),_:1})]),_:1},8,["modelValue"]),n("div",Te,[s(b,{onClick:Q,type:"primary",disabled:!i.value},{default:u(()=>[S("保存配置")]),_:1},8,["disabled"]),s(b,{onClick:X,type:"warning"},{default:u(()=>[S("重置配置")]),_:1})])])}}},Oe=U(Me,[["__scopeId","data-v-7187b426"]]),Be={class:"bgColor"},Ie={class:"header"},Je={class:"controls"},Ee={class:"content"},$e={class:"section"},Ue={__name:"testMain",setup(m){const g=C(!1),h=G(),O=r=>{h.updateGameModes(r),h.saveToLocalStorage()};return R(()=>{h.loadFromLocalStorage()}),(r,o)=>{const x=_e,p=A,y=de;return l(),c("div",Be,[n("div",Ie,[n("div",Je,[s(p,{onClick:o[0]||(o[0]=i=>g.value=!0),class:"settings-button"},{default:u(()=>[s(x,null,{default:u(()=>[s(M(ve))]),_:1})]),_:1})])]),n("div",Ee,[n("div",$e,[s(pe)])]),s(y,{modelValue:g.value,"onUpdate:modelValue":o[1]||(o[1]=i=>g.value=i),title:"版型设置","close-on-click-modal":!1,"close-on-press-escape":!1,class:"settings-dialog"},{default:u(()=>[s(Oe,{onUpdateConfig:O})]),_:1},8,["modelValue"])])}}},De=U(Ue,[["__scopeId","data-v-7df02f9c"]]);export{De as default};
